Note: Google Test filter = RenderCommandEncoderTest.drawUsingBindPushConstants
[==========] Running 1 test from 1 test suite.
[----------] Global test environment set-up.
[----------] 1 test from RenderCommandEncoderTest
[ RUN      ] RenderCommandEncoderTest.drawUsingBindPushConstants
[Tests] Creating D3D12 test device (debug layer: disabled)
[Tests] D3D12 test device requested (debug layer: disabled)
HeadlessD3D12Context: Debug layer enabled
HeadlessD3D12Context: Failed to enable experimental features (0x80004002) - signed DXIL required
HeadlessD3D12Context: Created device on HW adapter (FL 12.0)
HeadlessD3D12Context: Initialization complete
[Tests] D3D12 test device created OK
Device::createTexture: IGL format=16 -> DXGI format=28
Texture::createFromResource - SUCCESS: 4x4 format=16
Device::createTexture: IGL format=84 -> DXGI format=20
Texture::createFromResource - SUCCESS: 4x4 format=84
Device::createShaderModule() - stage=0, entryPoint='main', debugName=''
  Compiling HLSL from string (230 bytes) using DXC...
DXCCompiler: Initializing DXC compiler...
DXCCompiler: Validator initialized - DXIL signing available
DXCCompiler: Initialization successful (Shader Model 6.0+ enabled)
  DEBUG BUILD: Enabling shader debug info and disabling optimizations
DXCCompiler: Compiling shader '' with target 'vs_6_0' (230 bytes source)
  DXC: Debug mode enabled
DXCCompiler: Attempting DXIL validation and signing...
DXCCompiler: Validation status: 0x00000000
DXCCompiler: Got validated blob (6375 bytes)
DXCCompiler: DXIL validated and signed successfully
DXCCompiler: Compilation successful (6375 bytes DXIL bytecode)
  DXC shader compiled successfully (6375 bytes DXIL bytecode)
Device::createShaderModule() - stage=1, entryPoint='main', debugName=''
  Compiling HLSL from string (219 bytes) using DXC...
  DEBUG BUILD: Enabling shader debug info and disabling optimizations
DXCCompiler: Compiling shader '' with target 'ps_6_0' (219 bytes source)
  DXC: Debug mode enabled
DXCCompiler: Attempting DXIL validation and signing...
DXCCompiler: Validation status: 0x00000000
DXCCompiler: Got validated blob (7131 bytes)
DXCCompiler: DXIL validated and signed successfully
DXCCompiler: Compilation successful (7131 bytes DXIL bytecode)
  DXC shader compiled successfully (7131 bytes DXIL bytecode)
Device::createTexture: IGL format=16 -> DXGI format=28
Texture::createFromResource - SUCCESS: 4x4 format=16
Texture::upload() - START: 4x4
Texture::upload() - Proceeding with upload
Texture::upload() - Uploading 1 slices x 1 mips starting from slice 0, mip 0
Texture::upload() - Processing mip 0, slice 0 (subresource 0)
Texture::upload() - Dimensions: 4x4x1, bytesPerRow=16, numRows=4, totalBytes=784
Texture::upload() - Layout: RowPitch=256, Depth=1, Format=28, Dimension=3
Texture::upload() - Copy loop: depth=1, rows=4, srcDepthPitch=64, dstDepthPitch=1024
Texture::upload() - CopyTextureRegion: srcBox (0,0,0)->(4,4,1), dst offset (0,0,0)
Texture::upload() - Creating fence for GPU sync
Texture::upload() - Signaling fence and waiting...
Texture::upload() - Fence signaled, upload complete!
Texture::upload() - All 1 mips x 1 slices uploaded successfully
Device::createRenderPipeline() START - debugName=''
  Getting shader bytecode...
  VS bytecode: 6375 bytes, PS bytecode: 7131 bytes
  Creating root signature with Push Constants (b2)/CBVs (b0,b1)/SRVs/Samplers
  Serializing root signature...
  Root signature serialized OK
  Creating root signature...
  Root signature created OK
  PSO RenderTarget[0]: BlendEnable=0, SrcBlend=2, DstBlend=1, WriteMask=0x0F
  PSO Stencil configured: format=84
  PSO NumRenderTargets = 1 (color attachments = 1)
  PSO RTVFormats[0] = 28 (IGL format 16)
  Setting PSO topology type to POINT
  Processing vertex input state: 2 attributes
    Attribute 0: name='position_in', format=3, offset=0, bufferIndex=0
      Mapped 'position_in' -> 'POSITION'
      bufferIndex=0, isInstance=0, sampleFunc=1, InputSlotClass=0, StepRate=0
    Attribute 1: name='uv_in', format=1, offset=0, bufferIndex=1
      Mapped 'uv_in' -> 'TEXCOORD'
      bufferIndex=1, isInstance=0, sampleFunc=1, InputSlotClass=0, StepRate=0
  Final input layout: 2 elements
    [0]: POSITION (index 0), format 2, slot 0, offset 0
    [1]: TEXCOORD (index 0), format 16, slot 1, offset 0
  Reflecting vertex shader to verify input signature...
    Shader reflection unavailable: 0x80070057 (non-critical - pipeline will still be created)
  Creating pipeline state (this may take a moment)...
Device::createRenderPipeline() SUCCESS - PSO=0000027F19B36930, RootSig=0000027F19200840
RenderPipelineState: Set topology to POINTLIST
Device::createRenderPipeline() START - debugName=''
  Getting shader bytecode...
  VS bytecode: 6375 bytes, PS bytecode: 7131 bytes
  Creating root signature with Push Constants (b2)/CBVs (b0,b1)/SRVs/Samplers
  Serializing root signature...
  Root signature serialized OK
  Creating root signature...
  Root signature created OK
  PSO RenderTarget[0]: BlendEnable=0, SrcBlend=2, DstBlend=1, WriteMask=0x0F
  PSO Stencil configured: format=84
  PSO NumRenderTargets = 1 (color attachments = 1)
  PSO RTVFormats[0] = 28 (IGL format 16)
  Setting PSO topology type to LINE
  Processing vertex input state: 2 attributes
    Attribute 0: name='position_in', format=3, offset=0, bufferIndex=0
      Mapped 'position_in' -> 'POSITION'
      bufferIndex=0, isInstance=0, sampleFunc=1, InputSlotClass=0, StepRate=0
    Attribute 1: name='uv_in', format=1, offset=0, bufferIndex=1
      Mapped 'uv_in' -> 'TEXCOORD'
      bufferIndex=1, isInstance=0, sampleFunc=1, InputSlotClass=0, StepRate=0
  Final input layout: 2 elements
    [0]: POSITION (index 0), format 2, slot 0, offset 0
    [1]: TEXCOORD (index 0), format 16, slot 1, offset 0
  Reflecting vertex shader to verify input signature...
    Shader reflection unavailable: 0x80070057 (non-critical - pipeline will still be created)
  Creating pipeline state (this may take a moment)...
Device::createRenderPipeline() SUCCESS - PSO=0000027F19B37920, RootSig=0000027F19200840
RenderPipelineState: Set topology to LINELIST
Device::createRenderPipeline() START - debugName=''
  Getting shader bytecode...
  VS bytecode: 6375 bytes, PS bytecode: 7131 bytes
  Creating root signature with Push Constants (b2)/CBVs (b0,b1)/SRVs/Samplers
  Serializing root signature...
  Root signature serialized OK
  Creating root signature...
  Root signature created OK
  PSO RenderTarget[0]: BlendEnable=0, SrcBlend=2, DstBlend=1, WriteMask=0x0F
  PSO Stencil configured: format=84
  PSO NumRenderTargets = 1 (color attachments = 1)
  PSO RTVFormats[0] = 28 (IGL format 16)
  Setting PSO topology type to LINE
  Processing vertex input state: 2 attributes
    Attribute 0: name='position_in', format=3, offset=0, bufferIndex=0
      Mapped 'position_in' -> 'POSITION'
      bufferIndex=0, isInstance=0, sampleFunc=1, InputSlotClass=0, StepRate=0
    Attribute 1: name='uv_in', format=1, offset=0, bufferIndex=1
      Mapped 'uv_in' -> 'TEXCOORD'
      bufferIndex=1, isInstance=0, sampleFunc=1, InputSlotClass=0, StepRate=0
  Final input layout: 2 elements
    [0]: POSITION (index 0), format 2, slot 0, offset 0
    [1]: TEXCOORD (index 0), format 16, slot 1, offset 0
  Reflecting vertex shader to verify input signature...
    Shader reflection unavailable: 0x80070057 (non-critical - pipeline will still be created)
  Creating pipeline state (this may take a moment)...
Device::createRenderPipeline() SUCCESS - PSO=0000027F19A0ED50, RootSig=0000027F19200840
RenderPipelineState: Set topology to LINESTRIP
Device::createRenderPipeline() START - debugName=''
  Getting shader bytecode...
  VS bytecode: 6375 bytes, PS bytecode: 7131 bytes
  Creating root signature with Push Constants (b2)/CBVs (b0,b1)/SRVs/Samplers
  Serializing root signature...
  Root signature serialized OK
  Creating root signature...
  Root signature created OK
  PSO RenderTarget[0]: BlendEnable=0, SrcBlend=2, DstBlend=1, WriteMask=0x0F
  PSO Stencil configured: format=84
  PSO NumRenderTargets = 1 (color attachments = 1)
  PSO RTVFormats[0] = 28 (IGL format 16)
  Setting PSO topology type to TRIANGLE
  Processing vertex input state: 2 attributes
    Attribute 0: name='position_in', format=3, offset=0, bufferIndex=0
      Mapped 'position_in' -> 'POSITION'
      bufferIndex=0, isInstance=0, sampleFunc=1, InputSlotClass=0, StepRate=0
    Attribute 1: name='uv_in', format=1, offset=0, bufferIndex=1
      Mapped 'uv_in' -> 'TEXCOORD'
      bufferIndex=1, isInstance=0, sampleFunc=1, InputSlotClass=0, StepRate=0
  Final input layout: 2 elements
    [0]: POSITION (index 0), format 2, slot 0, offset 0
    [1]: TEXCOORD (index 0), format 16, slot 1, offset 0
  Reflecting vertex shader to verify input signature...
    Shader reflection unavailable: 0x80070057 (non-critical - pipeline will still be created)
  Creating pipeline state (this may take a moment)...
Device::createRenderPipeline() SUCCESS - PSO=0000027F19A0FD40, RootSig=0000027F19200840
RenderPipelineState: Set topology to TRIANGLELIST
Device::createRenderPipeline() START - debugName=''
  Getting shader bytecode...
  VS bytecode: 6375 bytes, PS bytecode: 7131 bytes
  Creating root signature with Push Constants (b2)/CBVs (b0,b1)/SRVs/Samplers
  Serializing root signature...
  Root signature serialized OK
  Creating root signature...
  Root signature created OK
  PSO RenderTarget[0]: BlendEnable=0, SrcBlend=2, DstBlend=1, WriteMask=0x0F
  PSO Stencil configured: format=84
  PSO NumRenderTargets = 1 (color attachments = 1)
  PSO RTVFormats[0] = 28 (IGL format 16)
  Setting PSO topology type to TRIANGLE
  Processing vertex input state: 2 attributes
    Attribute 0: name='position_in', format=3, offset=0, bufferIndex=0
      Mapped 'position_in' -> 'POSITION'
      bufferIndex=0, isInstance=0, sampleFunc=1, InputSlotClass=0, StepRate=0
    Attribute 1: name='uv_in', format=1, offset=0, bufferIndex=1
      Mapped 'uv_in' -> 'TEXCOORD'
      bufferIndex=1, isInstance=0, sampleFunc=1, InputSlotClass=0, StepRate=0
  Final input layout: 2 elements
    [0]: POSITION (index 0), format 2, slot 0, offset 0
    [1]: TEXCOORD (index 0), format 16, slot 1, offset 0
  Reflecting vertex shader to verify input signature...
    Shader reflection unavailable: 0x80070057 (non-critical - pipeline will still be created)
  Creating pipeline state (this may take a moment)...
Device::createRenderPipeline() SUCCESS - PSO=0000027F19A10D30, RootSig=0000027F19200840
RenderPipelineState: Set topology to TRIANGLESTRIP
Device::createBuffer: type=2, requested_size=16, aligned_size=16, isUniform=0
Device::createBuffer: type=2, requested_size=8, aligned_size=8, isUniform=0
Device::createShaderModule() - stage=0, entryPoint='main', debugName=''
  Compiling HLSL from string (238 bytes) using DXC...
  DEBUG BUILD: Enabling shader debug info and disabling optimizations
DXCCompiler: Compiling shader '' with target 'vs_6_0' (238 bytes source)
  DXC: Debug mode enabled
DXCCompiler: Attempting DXIL validation and signing...
DXCCompiler: Validation status: 0x00000000
DXCCompiler: Got validated blob (6379 bytes)
DXCCompiler: DXIL validated and signed successfully
DXCCompiler: Compilation successful (6379 bytes DXIL bytecode)
  DXC shader compiled successfully (6379 bytes DXIL bytecode)
Device::createShaderModule() - stage=1, entryPoint='main', debugName=''
  Compiling HLSL from string (329 bytes) using DXC...
  DEBUG BUILD: Enabling shader debug info and disabling optimizations
DXCCompiler: Compiling shader '' with target 'ps_6_0' (329 bytes source)
  DXC: Debug mode enabled
DXCCompiler: Attempting DXIL validation and signing...
DXCCompiler: Validation status: 0x00000000
DXCCompiler: Got validated blob (8091 bytes)
DXCCompiler: DXIL validated and signed successfully
DXCCompiler: Compilation successful (8091 bytes DXIL bytecode)
  DXC shader compiled successfully (8091 bytes DXIL bytecode)
Device::createRenderPipeline() START - debugName=''
  Getting shader bytecode...
  VS bytecode: 6379 bytes, PS bytecode: 8091 bytes
  Creating root signature with Push Constants (b2)/CBVs (b0,b1)/SRVs/Samplers
  Serializing root signature...
  Root signature serialized OK
  Creating root signature...
  Root signature created OK
  PSO RenderTarget[0]: BlendEnable=0, SrcBlend=2, DstBlend=1, WriteMask=0x0F
  PSO Stencil configured: format=84
  PSO NumRenderTargets = 1 (color attachments = 1)
  PSO RTVFormats[0] = 28 (IGL format 16)
  Setting PSO topology type to POINT
  Processing vertex input state: 2 attributes
    Attribute 0: name='position_in', format=3, offset=0, bufferIndex=0
      Mapped 'position_in' -> 'POSITION'
      bufferIndex=0, isInstance=0, sampleFunc=1, InputSlotClass=0, StepRate=0
    Attribute 1: name='uv_in', format=1, offset=0, bufferIndex=1
      Mapped 'uv_in' -> 'TEXCOORD'
      bufferIndex=1, isInstance=0, sampleFunc=1, InputSlotClass=0, StepRate=0
  Final input layout: 2 elements
    [0]: POSITION (index 0), format 2, slot 0, offset 0
    [1]: TEXCOORD (index 0), format 16, slot 1, offset 0
  Reflecting vertex shader to verify input signature...
    Shader reflection unavailable: 0x80070057 (non-critical - pipeline will still be created)
  Creating pipeline state (this may take a moment)...
Device::createRenderPipeline() SUCCESS - PSO=0000027F1921CD30, RootSig=0000027F19200840
RenderPipelineState: Set topology to POINTLIST
CommandBuffer::begin() - Resetting allocator...
CommandBuffer::begin() - Allocator reset OK, resetting command list...
CommandBuffer::begin() - Command list reset OK
RenderCommandEncoder::RenderCommandEncoder() - START
RenderCommandEncoder: Got context
RenderCommandEncoder: Using DescriptorHeapManager heaps
RenderCommandEncoder: CBV/SRV/UAV heap = 0000027F199801A0
RenderCommandEncoder: Sampler heap = 0000027F1998A0A0
RenderCommandEncoder: Setting descriptor heaps...
RenderCommandEncoder: Descriptor heaps set
RenderCommandEncoder: Setting up RTV...
RenderCommandEncoder: DescriptorHeapManager = 0000027F170601F0
RenderCommandEncoder: Checking framebuffer_=0000027F191A7860
RenderCommandEncoder: Has framebuffer with color attachment AND DescriptorHeapManager
RenderCommandEncoder: MRT count = 1 (indices.size=1)
RenderCommandEncoder: MRT loop i=0, tex=0000027F196D2B10, resource=0000027F198B67B0
RenderCommandEncoder: Clearing MRT attachment 0 with color (0.50, 0.50, 0.50, 0.50)
RenderCommandEncoder: MRT Created RTV #0, total RTVs now=1
RenderCommandEncoder: MRT Total RTVs created: 1
RenderCommandEncoder: Cleared depth-stencil (depth=1, stencil=1, depthVal=0.00, stencilVal=0)
RenderCommandEncoder: OMSetRenderTargets with 1 RTVs + DSV
RenderCommandEncoder: Setting default viewport...
RenderCommandEncoder: Using framebuffer color attachment
RenderCommandEncoder: Framebuffer dimensions: 4x4
RenderCommandEncoder: Set default viewport/scissor to 4x4
RenderCommandEncoder: Constructor complete!
bindTexture called #1: index=0, texture=0000027F196D2ED0
bindTexture: getting context...
bindTexture: resource=0000027F198BB310, format=16, dimensions=4x4
bindTexture: allocated descriptor slot 0 for texture index t0
bindTexture: resource dimension=3, texture type=1
bindTexture: using TEXTURE2D view dimension (mip offset=0, mip count=1)
bindTexture: heap=0000027F199801A0, heapStart CPU=0x27f1e0d5000, GPU=0x25678a00120000
bindTexture: creating SRV at slot 0, CPU handle 0x27f1e0d5000
bindTexture: cached texture[0] GPU handle 0x25678a00120000 (offset from heap start: 0)
bindTexture: done
bindSamplerState called #1: index=0, sampler=0000027F196ACD10
bindSamplerState: allocated descriptor slot 0 for sampler index s0
bindSamplerState: creating sampler at slot 0, CPU handle 0x27f1df95100
bindSamplerState: cached sampler[0] GPU handle 0x35678a00010100
bindVertexBuffer called #1: index=0
bindVertexBuffer called #2: index=1
bindViewport called #1: x=0.0, y=0.0, w=4.0, h=4.0
bindRenderPipelineState: PSO=0000027F1921CD30, RootSig=0000027F19200840
bindRenderPipelineState: Setting topology=1
Device::createBuffer: type=4, requested_size=256, aligned_size=256, isUniform=1
Device::createBuffer: Uniform buffer #1 created, GPU address=0x8954000
bindPushConstants: Created transient CB (16 bytes aligned to 256) and bound to root parameter 1 (b0) at GPU address 0x8954000
draw: VB[0] = GPU 0x879b000, size=16, stride=16
draw: VB[1] = GPU 0x8850000, size=8, stride=8
draw: DrawInstanced(vertexCount=1, instanceCount=1, firstVertex=0, baseInstance=0)
getCurrentBackBuffer(): index=0, resource=0000000000000000
CommandQueue::submit() - Executing command list...
CommandQueue::submit() - Command list executed, checking device status...
CommandQueue::submit() - Device OK, presenting...
CommandQueue::submit() - Signaled fence for frame 0 (value=1)
CommandQueue::submit() - Frame 1 resources already available (fence=0, completed=0)
CommandQueue::submit() - Complete!
CommandQueue::submit() - Aggregating 1 draws from CB into device
CommandQueue::submit() - Device drawCount now=1
unknown file: error: SEH exception with code 0x87d thrown in the test body.
Stack trace:


[  FAILED  ] RenderCommandEncoderTest.drawUsingBindPushConstants (1845 ms)
[----------] 1 test from RenderCommandEncoderTest (1845 ms total)

[----------] Global test environment tear-down
[==========] 1 test from 1 test suite ran. (1846 ms total)
[  PASSED  ] 0 tests.
[  FAILED  ] 1 test, listed below:
[  FAILED  ] RenderCommandEncoderTest.drawUsingBindPushConstants

 1 FAILED TEST
